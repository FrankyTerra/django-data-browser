{"version":3,"sources":["logo.png","Util.js","Results.js","Query.js","fieldNames.js","Components.js","App.js","index.js"],"names":["module","exports","assert","require","fetchInProgress","nextFetch","undefined","version","document","getElementById","textContent","trim","TLink","props","className","onClick","children","type","SLink","AbortError","name","Error","doFetch","url","options","process","reject","Promise","resolve","fetch","then","response","next","res","err","ok","status","response_version","headers","get","console","log","window","location","reload","doGet","method","json","useData","useState","data","setData","useEffect","updates","prev","Cookies","body","JSON","stringify","doPatch","catch","e","Save","apiUrl","redirectUrl","saving","setSaving","event","doPost","to","Delete","state","setState","Overlay","message","Object","prototype","hasOwnProperty","Spacer","spaces","Array","map","_","key","HeadCell","query","field","modelField","getField","path","getType","removeField","canPivot","togglePivot","pivoted","concrete","defaultLookup","addFilter","prettyPath","toggleSort","join","dsc","priority","asc","null","sort","DataCell","React","memo","formattedValue","span","value","formatHint","dangerouslySetInnerHTML","__html","highCutOff","lowCutOff","toExponential","significantFigures","toFixed","decimalPlaces","parts","toString","split","replace","String","colSpan","VTableHeadRow","fields","classNameFirst","i","pathStr","VTableBodyRow","row","formatHints","class","HTableRow","col","Results","cols","rows","overlay","colFields","rowFields","length","resFields","rowIndex","table","empty","filterErrors","getPartsForQuery","model","f","filters","lookup","limit","getUrlForQuery","baseUrl","media","query_str","basePath","origin","Query","config","setQuery","this","slice","allModelFields","types","lookup_type","lookups","choices","defaultValue","newFields","filter","priorities","newPriority","Math","max","push","index","findIndex","newSort","newFilters","getDefaultLookupValue","splice","Number","invalidNames","validNames","FilterValue","onChange","onChangeEvent","target","weekday","month","step","option","label","Filter","errorMessage","removeFilter","addField","defaultSort","setFilterLookup","sortedLookups","lookupName","initialText","ChoiceText","val","setFilterValue","Component","Filters","PrettyNameTranslate","result","Field","toggled","toggle","bind","prettyName","AllFields","modelFields","getModelFields","sortedFields","fieldName","includes","concat","ModelSelector","sortedModels","history","useHistory","defaultFilters","QueryPage","results","loading","error","setLimit","min","view","pk","EditSavedView","canMakePublic","useParams","setView","link","placeholder","style","display","createdTime","description","SavedViewList","savedViews","HomePage","list","element","QueryApp","popstate","booting","defaultRowLimit","Sentry","fetchResults","handleError","fieldStr","queryStr","reqState","replaceState","addEventListener","removeEventListener","queryChange","newState","request","pushState","sortBy","req","deepStrictEqual","handleQueryChange","Bob","useLocation","search","App","basename","id","parse","sentryDsn","dsn","release","attachStacktrace","maxValueLength","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.0bec3006.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.5e9039d9.png\";","import React, { useState, useEffect, useRef } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport Cookies from \"js-cookie\";\nimport \"./App.css\";\nconst assert = require(\"assert\");\nlet fetchInProgress = false;\nlet nextFetch = undefined;\n\nconst version = document.getElementById(\"backend-version\").textContent.trim();\n\nfunction CopyText(props) {\n    const { text } = props;\n    const ref = useRef(null);\n    return (\n        <>\n            <span ref={ref}>{text}</span>{\" \"}\n            <TLink\n                className=\"CopyToClipboard\"\n                onClick={(event) => {\n                    const range = document.createRange();\n                    range.selectNodeContents(ref.current);\n                    window.getSelection().removeAllRanges();\n                    window.getSelection().addRange(range);\n                    document.execCommand(\"copy\");\n                    window.getSelection().removeAllRanges();\n                    event.target.blur();\n                }}\n            >\n                (копировать в буфер)\n            </TLink>\n        </>\n    );\n}\n\nfunction TLink(props) {\n    const { className, onClick, children } = props;\n    return (\n        <button\n            {...{ onClick }}\n            type=\"button\"\n            className={\"Link \" + (className || \"\")}\n        >\n            {children}\n        </button>\n    );\n}\n\nfunction SLink(props) {\n    const { className, onClick, children } = props;\n    return (\n        <button\n            {...{ onClick }}\n            type=\"button\"\n            className={\"sLink material-icons \" + (className || \"\")}\n        >\n            {children}\n        </button>\n    );\n}\n\nclass AbortError extends Error {\n    name = \"AbortError\";\n}\n\nfunction doFetch(url, options, process) {\n    if (fetchInProgress) {\n        if (nextFetch) {\n            nextFetch.reject(new AbortError(\"skipped\"));\n        }\n        return new Promise((resolve, reject) => {\n            nextFetch = { resolve, reject, url, options, process };\n        });\n    }\n\n    fetchInProgress = true;\n\n    return fetch(url, options)\n        .then((response) => {\n            // do we have a next fetch we need to trigger\n            const next = nextFetch;\n            nextFetch = undefined;\n            fetchInProgress = false;\n\n            if (next) {\n                doFetch(next.url, next.options, next.process).then(\n                    (res) => next.resolve(res),\n                    (err) => next.reject(err)\n                );\n                throw new AbortError(\"superceeded\");\n            } else {\n                return response;\n            }\n        })\n        .then((response) => {\n            // check status\n            assert.ok(response.status >= 200);\n            assert.ok(response.status < 300);\n            return response;\n        })\n        .then((response) => {\n            // check server version\n            const response_version = response.headers.get(\"x-version\");\n            if (response_version !== version) {\n                console.log(\n                    \"Version mismatch, hard reload\",\n                    version,\n                    response_version\n                );\n                window.location.reload(true);\n            }\n            return response;\n        })\n        .then((response) => process(response)); // process data\n}\n\nfunction doGet(url) {\n    return doFetch(url, { method: \"GET\" }, (response) => response.json());\n}\n\nfunction doDelete(url) {\n    return doFetch(\n        url,\n        {\n            method: \"DELETE\",\n            headers: { \"X-CSRFToken\": Cookies.get(\"csrftoken\") },\n        },\n        (response) => response\n    );\n}\n\nfunction doPatch(url, data) {\n    return doFetch(\n        url,\n        {\n            method: \"PATCH\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"X-CSRFToken\": Cookies.get(\"csrftoken\"),\n            },\n            body: JSON.stringify(data),\n        },\n        (response) => response.json()\n    );\n}\n\nfunction doPost(url, data) {\n    return doFetch(\n        url,\n        {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"X-CSRFToken\": Cookies.get(\"csrftoken\"),\n            },\n            body: JSON.stringify(data),\n        },\n        (response) => response.json()\n    );\n}\n\nfunction useData(url) {\n    const [data, setData] = useState();\n    useEffect(() => {\n        doGet(url).then((response) => setData(response));\n    }, [url]);\n    return [\n        data,\n        (updates) => {\n            setData((prev) => ({ ...prev, ...updates }));\n            doPatch(url, updates)\n                .then((response) =>\n                    setData((prev) => ({ ...prev, ...response }))\n                )\n                .catch((e) => {\n                    if (e.name !== \"AbortError\") throw e;\n                });\n        },\n    ];\n}\n\nfunction Save(props) {\n    const { name, apiUrl, data, redirectUrl } = props;\n    const [saving, setSaving] = useState(\"save\");\n    if (saving === \"save\")\n        return (\n            <TLink\n                onClick={(event) => {\n                    setSaving(\"saving\");\n                    doPost(apiUrl, data).then((response) =>\n                        setSaving(response)\n                    );\n                }}\n            >\n                Сохранить\n            </TLink>\n        );\n    else if (saving === \"saving\") return <>Сохранение</>;\n    else {\n        const url =\n            typeof redirectUrl === \"function\"\n                ? redirectUrl(saving)\n                : redirectUrl;\n        return <Redirect to={url} />;\n    }\n}\n\nfunction Delete(props) {\n    const { name, apiUrl, redirectUrl } = props;\n    const [state, setState] = useState(\"normal\");\n    if (state === \"normal\")\n        return (\n            <TLink\n                onClick={(event) => {\n                    setState(\"confirm\");\n                }}\n            >\n                Удалить {name || \"\"}\n            </TLink>\n        );\n    else if (state === \"confirm\")\n        return (\n            <TLink\n                onClick={(event) => {\n                    setState(\"deleting\");\n                    doDelete(apiUrl).then((response) => setState(\"deleted\"));\n                }}\n            >\n                Вы уверены?\n            </TLink>\n        );\n    else if (state === \"deleting\") return \"Deleting\";\n    else if (state === \"deleted\") return <Redirect to={redirectUrl} />;\n    else throw new Error(`unknown delete state: ${state}`);\n}\n\nfunction Overlay(props) {\n    if (!props.message) return null;\n    return (\n        <div className=\"Overlay\">\n            <h1>{props.message}</h1>\n        </div>\n    );\n}\n\nfunction is(x: any, y: any) {\n    return (\n        (x === y && (x !== 0 || 1 / x === 1 / y)) || (x !== x && y !== y) // eslint-disable-line no-self-compare\n    );\n}\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\nfunction shallowEqual(objA: mixed, objB: mixed): boolean {\n    if (is(objA, objB)) {\n        return true;\n    }\n\n    if (\n        typeof objA !== \"object\" ||\n        objA === null ||\n        typeof objB !== \"object\" ||\n        objB === null\n    ) {\n        return false;\n    }\n\n    const keysA = Object.keys(objA);\n    const keysB = Object.keys(objB);\n\n    if (keysA.length !== keysB.length) {\n        console.log(\"different keys\", keysA, keysB);\n        return false;\n    }\n\n    // Test for A's keys different from B.\n    for (let i = 0; i < keysA.length; i++) {\n        if (\n            !hasOwnProperty.call(objB, keysA[i]) ||\n            !is(objA[keysA[i]], objB[keysA[i]])\n        ) {\n            console.log(\n                \"different key\",\n                keysA[i],\n                objA[keysA[i]],\n                objB[keysA[i]]\n            );\n            return false;\n        }\n    }\n\n    return true;\n}\n\nexport {\n    TLink,\n    SLink,\n    doPatch,\n    doGet,\n    doDelete,\n    doPost,\n    useData,\n    version,\n    Save,\n    Delete,\n    CopyText,\n    fetchInProgress,\n    Overlay,\n    shallowEqual,\n};\n","import React from \"react\";\nimport \"./App.css\";\nimport { TLink, SLink, Overlay } from \"./Util\";\n\nfunction Spacer(props) {\n  const { spaces } = props;\n  if (spaces > 0) {\n    return [...Array(spaces)].map((_, key) => (\n      <td className=\"Empty\" key={key} />\n    ));\n  }\n  return null;\n}\n\nfunction HeadCell(props) {\n  const { query, field, className } = props;\n  const modelField = query.getField(field.path);\n  const type = query.getType(modelField);\n  return (\n    <th {...{ className }}>\n      <SLink onClick={() => query.removeField(field)}>close</SLink>\n      {modelField.canPivot && (\n        <>\n          <SLink onClick={() => query.togglePivot(field)}>\n            {field.pivoted ? \"call_received\" : \"call_made\"}\n          </SLink>\n        </>\n      )}\n      {modelField.concrete && type.defaultLookup ? (\n        <>\n          <SLink onClick={() => query.addFilter(field.path, field.prettyPath)}>\n            filter_alt\n          </SLink>{\" \"}\n          <TLink onClick={() => query.toggleSort(field)}>\n            {field.prettyPath.join(\" \")}\n            {\n              {\n                dsc: `↑${field.priority}`,\n                asc: `↓${field.priority}`,\n                null: \"\",\n              }[field.sort]\n            }\n          </TLink>\n        </>\n      ) : (\n        \" \" + field.prettyPath.join(\" \")\n      )}\n    </th>\n  );\n}\n\nconst DataCell = React.memo((props) => {\n  const { modelField, className, span, value, formatHint } = props;\n  let formattedValue;\n  if (value === undefined) {\n    formattedValue = \"\";\n  } else if (value === null) {\n    formattedValue = null;\n  } else if (modelField.type === \"html\" && value) {\n    formattedValue = <div dangerouslySetInnerHTML={{ __html: value }} />;\n  } else if (modelField.type === \"number\") {\n    if (\n      value > formatHint.highCutOff ||\n      value < -formatHint.highCutOff ||\n      (value && value < formatHint.lowCutOff && value > -formatHint.lowCutOff)\n    ) {\n      formattedValue = value.toExponential(formatHint.significantFigures - 1);\n    } else {\n      formattedValue = value.toFixed(formatHint.decimalPlaces);\n      var parts = value.toFixed(formatHint.decimalPlaces).toString().split(\".\");\n      parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n      formattedValue = parts.join(\".\");\n    }\n  } else {\n    formattedValue = String(value);\n  }\n  return (\n    <td className={modelField.type + \" \" + className || \"\"} colSpan={span || 1}>\n      {formattedValue}\n    </td>\n  );\n});\n\nfunction VTableHeadRow(props) {\n  const { fields, query, classNameFirst, className } = props;\n  return fields.map((field, i) => (\n    <HeadCell\n      {...{ query, field }}\n      key={field.pathStr}\n      className={`HoriBorder ${className} ` + (i ? \"\" : classNameFirst)}\n    />\n  ));\n}\n\nfunction VTableBodyRow(props) {\n  const { fields, query, classNameFirst, className, row, formatHints } = props;\n  return fields.map((field, i) => {\n    if (row)\n      return (\n        <DataCell\n          key={field.pathStr}\n          value={row[field.pathStr]}\n          className={`${i ? \"\" : classNameFirst} ${className}`}\n          modelField={query.getField(field.path)}\n          formatHint={formatHints[field.pathStr]}\n        />\n      );\n    else\n      return (\n        <td key={field.pathStr} class={`${i ? \"\" : classNameFirst} Empty`}></td>\n      );\n  });\n}\n\nfunction HTableRow(props) {\n  const { query, field, data, span, className, formatHints } = props;\n  return (\n    <>\n      <HeadCell {...{ query, field }} />\n      {data.map((col, key) => (\n        <DataCell\n          {...{ key, span, className }}\n          value={col[field.pathStr]}\n          modelField={query.getField(field.path)}\n          formatHint={formatHints[field.pathStr]}\n        />\n      ))}\n    </>\n  );\n}\n\nfunction Results(props) {\n  const { query, cols, rows, body, overlay, formatHints } = props;\n  return (\n    <div className=\"Results\">\n      <Overlay message={overlay} />\n      <div className=\"Scroller\">\n        <table>\n          <thead>\n            {/* pivoted data */}\n            {query.colFields().map((field) => {\n              return (\n                <tr key={field.pathStr}>\n                  <Spacer spaces={query.rowFields().length - 1} />\n                  <HTableRow\n                    {...{ query, field, formatHints }}\n                    span={query.resFields().length}\n                    data={cols}\n                    className={overlay && \"Fade\"}\n                  />\n                </tr>\n              );\n            })}\n\n            {/* column headers */}\n            <tr>\n              <Spacer spaces={1 - query.rowFields().length} />\n              <VTableHeadRow\n                {...{ query }}\n                fields={query.rowFields()}\n                className=\"Freeze\"\n              />\n              {cols.map((_, key) => (\n                <VTableHeadRow\n                  {...{ key, query }}\n                  fields={query.resFields()}\n                  classNameFirst=\"LeftBorder\"\n                  className=\"Freeze\"\n                />\n              ))}\n            </tr>\n          </thead>\n\n          {/* row headers and body */}\n          <tbody className={overlay && \"Fade\"}>\n            {rows.map((row, rowIndex) => (\n              <tr key={rowIndex}>\n                <Spacer spaces={1 - query.rowFields().length} />\n                <VTableBodyRow\n                  {...{ query, row, formatHints }}\n                  fields={query.rowFields()}\n                />\n                {body.map((table, key) => (\n                  <VTableBodyRow\n                    {...{ key, query, formatHints }}\n                    fields={query.resFields()}\n                    row={table[rowIndex]}\n                    classNameFirst=\"LeftBorder\"\n                  />\n                ))}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n}\n\nexport { Results };\n","const empty = {\n  rows: [{}],\n  cols: [{}],\n  body: [[{}]],\n  length: 0,\n  filterErrors: [],\n  formatHints: {},\n};\n\nfunction getPartsForQuery(query) {\n  return {\n    model: query.model,\n    fields: query.fields\n      .map(\n        (f) =>\n          (f.pivoted ? \"&\" : \"\") +\n          f.path.join(\"__\") +\n          { asc: `+${f.priority}`, dsc: `-${f.priority}`, null: \"\" }[f.sort]\n      )\n      .join(\",\"),\n    query: query.filters\n      .map((f) => `${f.path.join(\"__\")}__${f.lookup}=${f.value}`)\n      .join(\"&\"),\n    limit: query.limit,\n  };\n}\n\nfunction getUrlForQuery(baseUrl, query, media) {\n  const { model, fields, query: query_str, limit } = getPartsForQuery(query);\n  const basePath = `${baseUrl}query/${model}`;\n  return `${window.location.origin}${basePath}/${fields}.${media}?${query_str}&limit=${limit}`;\n}\n\nclass Query {\n  constructor(config, query, setQuery) {\n    this.config = config;\n    this.query = query;\n    this.setQuery = setQuery;\n  }\n\n  getField(path) {\n    const field = path.slice(-1);\n    let model = this.query.model;\n    for (const field of path.slice(0, -1)) {\n      model = this.config.allModelFields[model].fields[field].model;\n    }\n    return this.config.allModelFields[model].fields[field];\n  }\n\n  getType(field) {\n    return this.config.types[field.type];\n  }\n\n  getModelFields(model) {\n    return this.config.allModelFields[model];\n  }\n\n  getDefaultLookupValue(field, type, lookup) {\n    const lookup_type = type.lookups[lookup].type;\n    if (lookup_type === \"numberchoice\" || lookup_type === \"stringchoice\")\n      return String(field.choices[0][0]);\n    else return String(this.config.types[lookup_type].defaultValue);\n  }\n\n  addField(path, prettyPath, sort) {\n    const newFields = this.query.fields.filter(\n      (f) => f.pathStr !== path.join(\"__\")\n    );\n    const priorities = newFields\n      .map((f) => f.priority)\n      .filter((f) => f !== null);\n    const newPriority = priorities.length ? Math.max(...priorities) + 1 : 0;\n    console.log(\"a\", priorities, newPriority);\n    newFields.push({\n      path: path,\n      pathStr: path.join(\"__\"),\n      prettyPath: prettyPath,\n      sort: sort,\n      priority: sort ? newPriority : null,\n      pivoted: false,\n    });\n    this.setQuery({ fields: newFields });\n  }\n\n  removeField(field) {\n    this.setQuery({\n      fields: this.query.fields.filter((f) => f.pathStr !== field.pathStr),\n    });\n  }\n\n  toggleSort(field) {\n    const index = this.query.fields.findIndex(\n      (f) => f.pathStr === field.pathStr\n    );\n    const newSort = { asc: \"dsc\", dsc: null, null: \"asc\" }[field.sort];\n    let newFields = this.query.fields.slice();\n\n    if (field.sort) {\n      // move any later sort fields forward\n      newFields = newFields.map((f) => ({\n        ...f,\n        priority:\n          f.priority != null && f.priority > field.priority\n            ? f.priority - 1\n            : f.priority,\n      }));\n    }\n\n    if (newSort) {\n      // move all other fiels back and insert the updated one\n      newFields = newFields.map((f) => ({\n        ...f,\n        priority: f.priority != null ? f.priority + 1 : f.priority,\n      }));\n      newFields[index] = { ...field, sort: newSort, priority: 0 };\n    } else {\n      // blank the sort on the updated field\n      newFields[index] = { ...field, sort: null, priority: null };\n    }\n\n    this.setQuery({\n      fields: newFields,\n    });\n  }\n\n  togglePivot(field) {\n    const index = this.query.fields.findIndex(\n      (f) => f.pathStr === field.pathStr\n    );\n    let newFields = this.query.fields.slice();\n    newFields[index].pivoted = !newFields[index].pivoted;\n    this.setQuery({\n      fields: newFields,\n    });\n  }\n\n  addFilter(path, prettyPath) {\n    const field = this.getField(path);\n    const type = this.getType(field);\n    const newFilters = this.query.filters.slice();\n    newFilters.push({\n      path: path,\n      pathStr: path.join(\"__\"),\n      prettyPath: prettyPath,\n      lookup: type.defaultLookup,\n      value: this.getDefaultLookupValue(field, type, type.defaultLookup),\n    });\n    this.setQuery({ filters: newFilters });\n  }\n\n  removeFilter(index) {\n    const newFilters = this.query.filters.slice();\n    newFilters.splice(index, 1);\n    this.setQuery({ filters: newFilters });\n  }\n\n  setFilterValue(index, value) {\n    const newFilters = this.query.filters.slice();\n    newFilters[index] = { ...newFilters[index], value: value };\n    this.setQuery({ filters: newFilters });\n  }\n\n  setFilterLookup(index, lookup) {\n    const newFilters = this.query.filters.slice();\n    const filter = newFilters[index];\n    const field = this.getField(newFilters[index].path);\n    const type = this.getType(field);\n    if (type.lookups[filter.lookup].type !== type.lookups[lookup].type) {\n      filter.value = this.getDefaultLookupValue(field, type, lookup);\n    }\n    filter.lookup = lookup;\n    this.setQuery({ filters: newFilters });\n  }\n\n  setLimit(limit) {\n    limit = Number(limit);\n    this.setQuery({ limit: limit > 0 ? limit : 1 });\n  }\n\n  getUrlForMedia(media) {\n    return getUrlForQuery(this.config.baseUrl, this.query, media);\n  }\n\n  colFields() {\n    return this.query.fields.filter((f) => f.pivoted);\n  }\n\n  rowFields() {\n    if (this.colFields().length) {\n      return this.query.fields.filter(\n        (f) => !f.pivoted && this.getField(f.path).canPivot\n      );\n    } else {\n      return this.query.fields;\n    }\n  }\n\n  resFields() {\n    if (this.colFields().length) {\n      return this.query.fields.filter((f) => !this.getField(f.path).canPivot);\n    } else {\n      return [];\n    }\n  }\n}\n\nexport { Query, getPartsForQuery, getUrlForQuery, empty };\n","export const invalidNames = [\n  'month_start',\n  'week_day',\n  'week_start',\n  'year',\n  'date',\n  'hour',\n  'minute',\n  'month_start',\n  'second',\n  'week_day',\n  'week_start',\n  'year'\n];\n\nexport const validNames = {\n  'count': 'Количество',\n  'day': 'День',\n  'is_null': 'Пустое значение',\n  'iso_week': 'Неделя',\n  'iso_year': 'Год',\n  'max': 'Максимальное значение',\n  'min': 'Минимальное значение',\n  'month': 'Месяц',\n  'average': 'Среднее значение',\n  'sum': 'Сумма',\n  'quarter': 'Квартал',\n  'auth.Group': 'группы',\n  'n3calendar.ProductionCalendarDay': 'Производственные календарные дни',\n  'oks.OKS': 'Объекты капитального строительства',\n  'oks.OKSPassportFileLog': 'Логи изменения паспортов ОКС',\n  'oks.Expertise': 'Экспертизы УГЭ',\n  'oks.OKSWorkStage': 'Этапы работ по ОКС',\n  'oks.OKSWorkPhase': 'Стадии работ по ОКС',\n  'oks.ConstructiveType': 'Виды конструкций',\n  'oks.OKSPassportActualization': 'Актуализация паспортов ОКС',\n  'oks.OKSPhoto': 'Фото ОКС',\n  'oks.OKSVideo': 'Видео ОКС',\n  'oks.EstimatedCostReliabilityConclusion': 'Заключения о достоверности определения сметной стоимости',\n  'oks.OKSHousing': 'Корпусы',\n  'oks.OKSProblemQuestion': 'Проблемные вопросы',\n  'oks.StateCase': 'Состояние дел',\n  'oks.OKSWarranty': 'Гарантийные обязательства по ОКС',\n  'orders.Offer': 'Предложения о включении ОКС в АИП',\n  'orders.Order': 'Заявки отраслевых комитетов',\n  'orders.OrderDocType': 'Типы документов заявки отраслевых комитетов',\n  'orders.OrderReturnReason': 'Причины возвращения заявки отраслевых комитетов',\n  'orders.OrderAdministration': 'Заявки администраций районов',\n  'orders.OrderAdministrationReturnReason': 'Причины возвращения заявки администраций районов',\n  'orders.OfferDoc': 'Документы заявки администраций районов',\n  'organizations.Organization': 'Организации',\n  'organizations.OrganizationalUnit': 'Организационные подразделения',\n  'organizations.Sector': 'Отрасли',\n  'organizations.Position': 'Должности',\n  'users.User': 'пользователи',\n  'users.OrganizationUnitRole': 'Роли отделов',\n  'aip.OKSAIPEventPrice': 'Суммы ОКС в мероприятиях АИП',\n  'aip.AdjustmentOKSAIPEventPrice': 'Суммы ОКС по мероприятиям АИП в корректировках АИП',\n  'aip.AIPAdjustment': 'Корректировки АИП',\n  'aip.AdjustmentOKSAIPEvent': 'Списки ОКС в мероприятиях АИП в корректировке АИП',\n  'aip.OKSAIPEvent': 'Списки ОКС в мероприятиях АИП',\n  'aip.AIPCast': 'Слепки АИП',\n  'aip.CastOKSAIPEvent': 'Списки ОКС в мероприятиях АИП в слепках АИП',\n  'aip.Aip': 'Адресные инвестиционные программы',\n  'aip.EventsAip': 'Мероприятия АИП',\n  'aip.EventIncludeAip': 'Включенные мероприятия АИП',\n  'aip.AdjustmentIncludedEvent': 'Включенные мероприятия АИП в корректировках АИП',\n  'aip.CastIncludedEvent': 'Слепки включенных мероприятий АИП',\n  'aip.CheckDigits': 'Контрольные цифры',\n  'aip.OKSContentProtocolMvk': 'ОКСы в строках протоколов МВК',\n  'aip.ResponsibleForExecution': 'Ответственные за исполнения',\n  'aip.ProtocolMvk': 'Протоколы МВК',\n  'aip.ContentsProtocolMvk': 'Строки протоколов МВК',\n  'aip.CostEventsAipProtocolMvk': 'Суммы по мероприятиям АИП в протоколе МВК',\n  'gp.EventsGP': 'Мероприятия государственной программы',\n  'gp.EventIncludeGP': 'Включенные мероприятия ГП',\n  'gp.GP': 'Государственные программы',\n  'gp.SubGP': 'Подпрограммы государственной программы',\n  'gp.StageGP': 'Этапы строительства мероприятия ГП',\n  'gp.CostStage': 'Суммы по этапу мероприятия ГП',\n  'gp.SourceFinance': 'Источники финансирования',\n  'gp.StageOKS': 'Списки ОКС в этапе мероприятия ГП',\n  'gp.GPProjectChange': 'Предложения о внесения изменений в ГП',\n  'gp.Adjustment': 'Корректировки ГП',\n  'gp.TargetedItems': 'целевые статьи расходов',\n  'gp.RealizationSchedule': 'Планы-графики реализации ГП',\n  'gp.RealizationScheduleGPEvent': 'Мероприятия ГП в плане-графике реализации ГП',\n  'assignments.Assignment': 'Поручения фонда капитального строительства и реконструкции',\n  'assignments.AssignmentContent': 'Строки объектов капитального строительства',\n  'gk.GK': 'Государственные контракты',\n  'gk.AdditionalOKSGK': 'Дополнительные ОКС ГК',\n  'gk.GKComment': 'Комментарии к государственным контрактам',\n  'gk.LimitByYear': 'Лимиты финансирования по годам',\n  'gk.QuarterLimit': 'Лимиты по кварталам',\n  'gk.Builder': 'Подрядчики',\n  'gk.DS': 'Дополнительные соглашения',\n  'gk.PurchaseSchedule': 'План-графики закупок',\n  'gk.PaymentDocs': 'Платежные документы исполнения',\n  'gk.GKPrepaymentDoc': 'Платежные документы закрытия аванса',\n  'gk.PaymentPlan': 'Планы платежей ГК',\n  'gk.PaymentOrder': 'Платежные поручения',\n  'gk.GKPrepayment': 'Авансы контрактов',\n  'gk.ClosingDocument': 'Закрывающие документы',\n  'gk.ProcurementPlanContent': 'Строки планов закупок',\n  'gk.WorkType': 'Виды проводимых работ',\n  'gk.BuilderSettingRating': 'Настройка для расчета рейтинга подрядной организации',\n  'gk.AcceptedWork': 'Принимаемые работы',\n  'gk.ProcurementPlanPurchase': 'Закупки планов закупок',\n  'gk.AdditionalOKSProcurementPlanPurchase': 'Дополнительные ОКС для закупок ПЗ',\n  'gk.PurchaseSchedulePurchase': 'Закупки плана-графика закупок',\n  'gk.AdditionalOKSPurchaseSchedulePurchase': 'Дополнительные ОКС для закупок ПГЗ',\n  'gk.GKRepayment': 'Погашения',\n  'gk.PriceByYear': 'Стоимости по годам',\n  'gk.GKSchedule': 'Календарные планы выполнения ГК',\n  'gk.GKScheduleStage': 'Этапы календарных планов по ГК',\n  'gk.GKScheduleContent': 'Строки календарного плана выполнение ГК',\n  'gk.GKPrepaymentWork': 'Авансируемые работы',\n  'gk.PaymentPlanSum': 'Суммы плана платежей ГК',\n  'gk.GKRepaymentSchedule': 'Графики погашения',\n  'gk.GKLot': 'Лоты госконтракта',\n  'gk.OKVED': 'ОКВЭД',\n  'gk.OKPD': 'ОКПД',\n  'gk.Method': 'Способы закупки',\n  'gk.TechnologicalConnectionType': 'Типы технологического присоединения',\n  'gk.TechnologicalConnectionParam': 'Параметры технологического присоединения Договора',\n  'gk.AIPEventPlanningPrice': 'Плановые стоимости мероприятий АИП',\n  'gk.ProcurementPlan': 'Планы закупок',\n  'gk.PurchaseScheduleContent': 'Строки плана-графика закупок',\n  'gk.MeasurementUnit': 'Единицы измерения',\n  'gk.GKTypeProvision': 'Виды обеспечений контрактов',\n  'gk.GKProvision': 'Обеспечения контрактов',\n  'gk.ReasonFailedProcedure': 'Причины несостоявшейся процедуры',\n  'gk.ClosingDocumentType': 'Типы закрывающих документов',\n  'docs.DocType': 'Типы документов',\n  'docs.Doc': 'Прикрепленные Документы',\n  'docs.OrganizationIssuedDoc': 'Организации, выдавшие документы',\n  'settings.Settings': 'Параметры системы',\n  'settings.VAT': 'НДС',\n  'news.News': 'Новости',\n  'uas.Address': 'Адреса',\n  'uas.Prefix': 'Префиксы (текстовая часть адреса)',\n  'uas.Building': 'Строения',\n  'uas.Fias': 'Соответствия кодам ФИАС',\n  'uas.Toponim': 'Топонимы',\n  'uas.Area': 'Площадные объекты',\n  'uas.AreaType': 'Типы площадных объектов',\n  'uas.Geonim': 'Геонимы',\n  'uas.GeonimType': 'Типы геонимов',\n  'uas.Town': 'Города-поселки',\n  'uas.Municipality': 'Муниципальные округа',\n  'uas.SubRF': 'Субъекты РФ',\n  'uas.District': 'Районы',\n  'uas.Sources': 'Организации-источники',\n  'uas.IdBuildingChanges': 'Перекодирование объектов',\n  'support.TypeAppeal': 'Темы обращений',\n  'support.Appeal': 'Обращения',\n  'support.AppealInfoMessage': 'Информационное сообщение',\n  'support.FAQ': 'Часто задаваемые вопросы',\n  'support.TechnicalWork': 'Технические работы',\n  'support.TechnicalWorkNotice': 'Отметки о просмотре служебных уведомлений',\n  'notification.NotificationRecipients': 'Оповещения',\n  'notification.NotificationEvent': 'Отложенные email-уведомления',\n  'projects.Project': 'Проекты',\n  'projects.ProjectPhase': 'Стадии проектов',\n  'projects.ProjectStage': 'Этапы проектов',\n  'projects.ProjectEvent': 'Мероприятия проектов',\n  'projects.ProjectTaskType': 'Типы задач проектов',\n  'projects.ProjectTask': 'Задачи проектов',\n  'projects.RoadMapTemplateStage': 'Шаблоны - этапы проектов',\n  'projects.RoadMapTemplateEvent': 'Шаблоны - мероприятия проектов',\n  'projects.RoadMapTemplateTask': 'Шаблоны - задачи проектов',\n  'projects.RoadMapTemplate': 'Шаблоны дорожной карты проекта',\n  'projects.ProcessStage': 'Этапы регламентированного процесса',\n  'projects.Process': 'Регламентированные процессы',\n  'projects.ProjectTaskComment': 'Комментарии задач проектов',\n  'projects.ProjectSettingRating': 'Настройка рейтинга проектов',\n  'projects.CoordinationRoute': 'Маршруты согласования',\n  'projects.ProjectType': 'Типы проектов',\n  'projects.ProjectPhaseType': 'Типы стадий проекта',\n  'projects.ProjectStageType': 'Типы этапов проекта',\n  'projects.ProjectEventType': 'Типы мероприятий проекта',\n  'projects.ProjectDelegation': 'Делегирования полномочий',\n  'projects.ProgramType': 'Типы программ',\n  'projects.Program': 'Программы проектов',\n  'projects.BasePlanVersion': 'Версии базовых планов',\n  'projects.TemplatePreviewTask': 'Предпросмотр задач',\n  'projects.TemplatePreviewEvent': 'Предпросмотр мероприятий',\n  'projects.TemplatePreviewStage': 'Предпросмотр этапов',\n  'projects.TemplatePreviewPhase': 'Предпросмотр стадий',\n  'projects.CoordinationRouteStep': 'Шаги согласования',\n  'projects.FactualQuantity': 'Фактические количества',\n  'projects.ProductionProgram': 'Производственные программы',\n  'projects.ProductionProgramPlanValues': 'Плановые значения количества людей и техники',\n  'claim_work.DocumentBase': 'Документы оснований начала претензионных работ',\n  'claim_work.ClaimCase': 'Претензионные дела',\n  'claim_work.CourtCase': 'Судебные дела',\n  'claim_work.JudicialSitting': 'Судебные заседания',\n  'claim_work.DemandType': 'Виды требований',\n  'claim_work.Claim': 'Претензии',\n  'claim_work.ClaimRecovery': 'Взыскания по претензиям',\n  'claim_work.ClaimRecoveryPaymentDoc': 'Документы исполнения взысканий',\n  'claim_work.Bank': 'Банки',\n  'claim_work.Court': 'Суды',\n  'claim_work.CourtCaseCategory': 'Категории судебных дел',\n  'work_schedule.Work': 'Планируемые работы',\n  'work_schedule.BlockWorks': 'Планируемые блоки работ',\n  'work_schedule.WorkSchedule': 'Календарные план-графики',\n  'aip_monitoring.Precept': 'Предписания об устранении выявленных нарушений',\n  'aip_monitoring.ExpectedExecution': 'Ожидаемые выполнения',\n  'aip_monitoring.Report': 'Отчеты инженеров по строительному контролю',\n  'aip_monitoring.Departure': 'Выезды инженеров по строительному контролю',\n  'aip_monitoring.DepartureSchedule': 'Графики выездов инженеров по строительному контролю',\n  'aip_monitoring.DepartureResponsible': 'Ответственные за выезды',\n  'aip_monitoring.DepartureWork': 'Работы к проверкам на даты выездов',\n  'aip_monitoring.Objection': 'Возражения',\n  'oks_planned_calculation.PlannedCalculation': 'Плановые расчеты стоимостей',\n  'oks_planned_calculation.CalculationTechnologicalConnectionType': 'Типы технологического присоединения для расчета стоимости',\n  'oks_planned_calculation.CalculationTechnologicalConnectionParam': 'Параметры технологического присоединения для расчета стоимости',\n  'oks_planned_calculation.PlannedCalculationWorkTypePrice': 'Суммы плановых расчетов по видам работ',\n  'oks_planned_calculation.PlannedCalculationTotalPrice': 'Итоговые суммы плановых расчетов',\n  'oks_planned_calculation.PlannedCalculationVersion': 'Версии плановых расчетов стоимостей',\n  'uds.ProjectDeclaration': 'Проектные декларации',\n  'uds.DeveloperFounder': 'Учредители застройщика',\n  'uds.MembershipSRO': 'Членства СРО',\n  'uds.DeveloperProject': 'Проекты строительства',\n  'uds.ResidentialComplex': 'Жилые комплексы',\n  'uds.ZuTypeOwnership': 'Типы собственности на ЗУ',\n  'uds.BuildingObject': 'Объекты застройки',\n  'uds.BuildingTechnicalConnector': 'Технологические присоединения объектов застройки',\n  'uds.ProjectImplementionSchedule': 'Графики реализации проекта',\n  'uds.ShareAgreement': 'Договоры долевого участия',\n  'essk.ChangedObjectSentLog': 'Логи отправки изменённых объектов',\n  'essk.Job': 'Дела',\n  'essk.Application': 'Информация о заявлениях',\n  'essk.InterdepRequest': 'Межведомственные запросы',\n  'essk.InterdepResponse': 'Межведомственные ответы',\n  'essk.DocumentType': 'Типы документов',\n  'essk.Document': 'Документы',\n  'essk.Subject': 'Темы межведомственных запросов дел',\n  'essk.Organization': 'Организации',\n  'essk.Procedure': 'Процедуры',\n  'essk.ChangedObjects': 'Изменённые объекты',\n  'uds_report.QuarterlyReportType': 'Типы ежеквартальных отчетов',\n  'uds_report.QuarterlyReportingPackage': 'Пакеты ежеквартальных отчетностей',\n  'uds_report.QuarterlyReport': 'Ежеквартальные отчеты',\n  'uds_report.AnnualReportType': 'Типы годовых отчетов',\n  'uds_report.AnnualReportingPackage': 'Пакеты годовых отчетностей',\n  'uds_report.AnnualReport': 'Годовые отчеты',\n  'uds_report.AuditReport': 'Аудиторские заключения',\n  'uds_report.DDUSignedCast': 'Подписанные слепки ДДУ',\n  'uds_report.CautionReport': 'Предостережения',\n  'uds_report.Objection': 'Возражения',\n  'uds_report.AuditPlan': 'Планы проверок',\n  'uds_report.AuditPlanEvent': 'Мероприятия планов проверок',\n  'media_inquiry.Inquiry': 'Запросы СМИ',\n  'reports.ManualReport': 'Ручные отчеты',\n  'rating.Rating': 'Рейтинги',\n  'financial_management.CashPlan': 'Кассовые планы',\n  'financial_management.BudgetPaymentDoc': 'Платежные документы из бюджета',\n  'financial_management.PlannedDevelopment': 'Планируемые освоения',\n  'financial_management.PaymentDistribution': 'Распределения платежей',\n  'gorod.Problem': 'Обращения граждан',\n  'gorod.ProblemHistory': 'История обращения',\n  'gorod.ProblemDoc': 'Документы обращения',\n  'system_security.Backup': 'Бэкапы',\n  'system_security.SecurityLog': 'Журналирование событий безопасности',\n  'version_control.ModelObjectVersion': 'Версии объектов',\n  'version_control.ModelObjectVersionGroup': 'Группы версий объектов',\n  'system_security.HistoryRecord': 'Записи изменений',\n  'system_security.ModelObjectHistory': 'Истории изменений объектов',\n  'sign_manager.SignManagerSignature': 'Подписи объектов',\n  'aisbp.AISBPRequest': 'Запросы в АИС БП, ожидающие получения данных',\n  'aisbp.AISBPRequestLog': 'Логи запроса в АИС БП',\n  'eis.EISLastUpdate': 'История обновления данных из ЕИС',\n  'eis.EISWrongFiles': 'Нечитаемые файлы',\n  'eis.OKPDProxy': 'ОКПД',\n  'eis.OKVEDProxy': 'ОКВЭД',\n  'eis.MethodProxy': 'Способы закупки',\n  'eis.ReasonFailedProcedureProxy': 'Причины несостоявшейся процедуры',\n  'eis.MeasurementUnitProxy': 'Единицы измерения'\n}","import React from \"react\";\nimport { Link, useParams, useHistory } from \"react-router-dom\";\nimport { TLink, SLink, useData, version, Save, Delete, CopyText } from \"./Util\";\nimport { Results } from \"./Results\";\nimport { getPartsForQuery } from \"./Query\";\nimport logo from \"./logo.png\";\nimport { validNames, invalidNames } from './fieldNames';\nimport \"./App.css\";\n\nfunction FilterValue(props) {\n  const { lookup, onChange, value, field } = props;\n  const onChangeEvent = (e) => onChange(e.target.value);\n  if (props.lookup.type === \"boolean\")\n    return (\n      <select {...{ value }} onChange={onChangeEvent} className=\"FilterValue\">\n        <option value={true}>true</option>\n        <option value={false}>false</option>\n      </select>\n    );\n  else if (lookup.type === \"weekday\")\n    return (\n      <select {...{ value }} onChange={onChangeEvent} className=\"FilterValue\">\n        {[\n          \"Воскресенье\",\n          \"Понедельник\",\n          \"Вторник\",\n          \"Среда\",\n          \"Четверг\",\n          \"Пятница\",\n          \"Суббота\",\n        ].map((weekday) => (\n          <option value={weekday}>{weekday}</option>\n        ))}\n      </select>\n    );\n  else if (lookup.type === \"month\")\n    return (\n      <select {...{ value }} onChange={onChangeEvent} className=\"FilterValue\">\n        {[\n          \"Январь\",\n          \"Февраль\",\n          \"Март\",\n          \"Апрель\",\n          \"Май\",\n          \"Июнь\",\n          \"Июль\",\n          \"Август\",\n          \"Сентябрь\",\n          \"Октябрь\",\n          \"Ноябрь\",\n          \"Декабрь\",\n        ].map((month) => (\n          <option value={month}>{month}</option>\n        ))}\n      </select>\n    );\n  else if (\n    field.choices.length &&\n    (lookup.type === \"numberchoice\" || lookup.type === \"stringchoice\")\n  )\n    return (\n      <select {...{ value }} onChange={onChangeEvent} className=\"FilterValue\">\n        {field.choices.map(([option, label]) => (\n          <option value={option}>{label}</option>\n        ))}\n      </select>\n    );\n  else if (\n    lookup.type === \"number\" ||\n    lookup.type === \"numberchoice\" ||\n    lookup.type === \"year\"\n  )\n    return (\n      <input\n        {...{ value }}\n        onChange={onChangeEvent}\n        className=\"FilterValue\"\n        type=\"number\"\n        step=\"0\"\n      />\n    );\n  else if (lookup.type === \"jsonfield\") {\n    const parts = value.split(/\\|(.*)/);\n    return (\n      <>\n        <input\n          value={parts[0]}\n          onChange={(e) => onChange(`${e.target.value}|${parts[1]}`)}\n          className=\"FilterValue Half\"\n          type=\"text\"\n        />\n        <input\n          value={parts[1]}\n          onChange={(e) => onChange(`${parts[0]}|${e.target.value}`)}\n          className=\"FilterValue Half\"\n          type=\"text\"\n        />\n      </>\n    );\n  } else\n    return (\n      <input\n        {...{ value }}\n        onChange={onChangeEvent}\n        className=\"FilterValue\"\n        type=\"text\"\n      />\n    );\n}\n\nfunction ChoiceText(initialText) {\n  switch (initialText) {\n    case 'equals':\n      return 'Равно';\n      break;\n    case 'contains':\n      return 'Содержит';\n      break;\n    case 'starts_with':\n      return 'Начинается с';\n      break;\n    case 'ends_with':\n      return 'Заканчивается на';\n      break;\n    case 'regex':\n      return 'Регулярное выражение (совпадение)';\n      break;\n    case 'not_equals':\n      return 'Не равно';\n      break;\n    case 'not_contains':\n      return 'Не содержит';\n      break;\n    case 'not_starts_with':\n      return 'Начинается не с';\n      break;\n    case 'not_ends_with':\n      return 'Заканчивается не на';\n      break;\n    case 'not_regex':\n      return 'Регулярное выражение (исключение)';\n      break;\n    case 'is_null':\n      return 'Пустое значение';\n      break;\n    case 'gt':\n      return 'Больше';\n      break;\n    case 'gte':\n      return 'Больше или равно';\n      break;\n    case 'lt':\n      return 'Меньше';\n      break;\n    case 'lte':\n      return 'Меньше или равно';\n      break;\n    default:\n      return initialText\n      break;\n  }\n}\n\nclass Filter extends React.Component {\n  render() {\n    const {\n      path,\n      prettyPath,\n      index,\n      lookup,\n      query,\n      value,\n      errorMessage,\n    } = this.props;\n    const field = query.getField(path);\n    const type = query.getType(field);\n    return (\n      <tr>\n        <td>\n          <SLink onClick={() => query.removeFilter(index)}>close</SLink>{\" \"}\n          <TLink\n            onClick={() => query.addField(path, prettyPath, type.defaultSort)}\n          >\n            {prettyPath.join(\" \")}\n          </TLink>{\" \"}\n        </td>\n        <td>\n          <select\n            className=\"Lookup\"\n            value={lookup}\n            onChange={(e) => query.setFilterLookup(index, e.target.value)}\n          >\n            {type.sortedLookups.map((lookupName) => (\n              <option key={lookupName} value={lookupName}>\n                {ChoiceText(lookupName)}\n              </option>\n            ))}\n          </select>\n        </td>\n        <td>=</td>\n        <td>\n          <FilterValue\n            {...{ value, field }}\n            onChange={(val) => query.setFilterValue(index, val)}\n            lookup={type.lookups[lookup]}\n          />\n          {errorMessage && <p className=\"Error\">{errorMessage}</p>}\n        </td>\n      </tr>\n    );\n  }\n}\n\nfunction Filters(props) {\n  const { query, filterErrors } = props;\n  return (\n    <form className=\"Filters\">\n      <table className=\"Flat\">\n        <tbody>\n          {props.filters.map((filter, index) => (\n            <Filter\n              {...{ query, index }}\n              {...filter}\n              key={index}\n              errorMessage={filterErrors[index]}\n            />\n          ))}\n        </tbody>\n      </table>\n    </form>\n  );\n}\n\nfunction PrettyNameTranslate(initialText) {\n  let result = initialText;\n  if (validNames[initialText]) {\n    result = validNames[initialText];\n  };\n  return result;\n}\n\nclass Field extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { toggled: false };\n  }\n\n  toggle() {\n    this.setState((state) => ({\n      toggled: !state.toggled,\n    }));\n  }\n\n  render() {\n    const { query, path, prettyPath, modelField } = this.props;\n    const type = query.getType(modelField);\n\n    return (\n      <>\n        <tr>\n          <td>\n            {modelField.concrete && type.defaultLookup && (\n              <SLink onClick={() => query.addFilter(path, prettyPath)}>\n                filter_alt\n              </SLink>\n            )}\n          </td>\n          <td>\n            {modelField.model && (\n              <SLink className=\"ToggleLink\" onClick={this.toggle.bind(this)}>\n                {this.state.toggled ? \"remove\" : \"add\"}\n              </SLink>\n            )}\n          </td>\n          <td>\n            {modelField.type ? (\n              <TLink\n                onClick={() =>\n                  query.addField(path, prettyPath, type.defaultSort)\n                }\n              >\n                {PrettyNameTranslate(modelField.prettyName)}\n              </TLink>\n            ) : (\n              PrettyNameTranslate(modelField.prettyName)\n            )}\n          </td>\n        </tr>\n        {this.state.toggled && (\n          <tr>\n            <td></td>\n            <td colSpan=\"2\">\n              <AllFields\n                {...{ query, path, prettyPath }}\n                model={modelField.model}\n              />\n            </td>\n          </tr>\n        )}\n      </>\n    );\n  }\n}\n\nfunction AllFields(props) {\n  const { query, model, path, prettyPath } = props;\n  const modelFields = query.getModelFields(model);\n  return (\n    <table>\n      <tbody>\n        {modelFields.sortedFields.map((fieldName) => {\n          const modelField = modelFields.fields[fieldName];\n          if (invalidNames.includes(fieldName)) {\n            return null;\n          } else {\n            return (\n              <Field\n                key={fieldName}\n                {...{ query, modelField }}\n                path={path.concat([fieldName])}\n                prettyPath={prettyPath.concat([modelField.prettyName])}\n              />\n            );\n          }\n        })}\n      </tbody>\n    </table>\n  );\n}\n\nfunction ModelSelector(props) {\n  const { sortedModels, allModelFields, model } = props;\n  const history = useHistory();\n  return (\n    <select\n      className=\"ModelSelector\"\n      onChange={(e) => {\n        history.push(\n          `/query/${e.target.value}/.html?${\n            allModelFields[e.target.value].defaultFilters\n          }`\n        );\n        window.location.reload(true);\n      }}\n      value={model}\n    >\n      {sortedModels.map((model) => (\n        <option value={model}>{validNames[model]}</option>\n      ))}\n    </select>\n  );\n}\n\nfunction Logo(props) {\n  return (\n    <Link to=\"/\" className=\"Logo\">\n      <span>Конструктор запросов</span>\n      <span className=\"Version\">v{version}</span>\n    </Link>\n  );\n}\n\nfunction LogoKS() {\n  return (\n    <div className=\"header\">\n      <div className=\"row\">\n        <div className=\"header__logo\">\n          <a href=\"/\">\n            <img src={logo} alt=\"\" />\n          </a>\n        </div>\n        <div className=\"header__text text\">\n            <div className=\"text__main\">\n                <span>Автоматизированная информационная система</span>\n            </div>\n            <div className=\"text__sub\">\n                <span>Комитета по строительству</span>\n            </div>\n        </div>\n      </div>\n    </div>\n\n  );\n}\n\nfunction QueryPage(props) {\n  const {\n    query,\n    rows,\n    cols,\n    body,\n    length,\n    sortedModels,\n    allModelFields,\n    model,\n    filters,\n    filterErrors,\n    baseUrl,\n    loading,\n    error,\n    formatHints,\n  } = props;\n\n  let overlay;\n  if (loading) overlay = \"Loading...\";\n  else if (error) overlay = \"Error\";\n\n  let results;\n  if (query.rowFields().length || query.colFields().length)\n    results = (\n      <Results {...{ query, rows, cols, body, overlay, formatHints }} />\n    );\n  else results = <h2>Не выбраны поля</h2>;\n\n  return (\n    <>\n      <ModelSelector {...{ query, sortedModels, allModelFields, model }} />\n      <Filters {...{ query, filters, filterErrors }} />\n      <p>\n        <span className={length >= query.query.limit ? \"Error\" : \"\"}>\n          Ограничение:{\" \"}\n          <input\n            className=\"RowLimit\"\n            type=\"number\"\n            value={query.query.limit}\n            onChange={(event) => {\n              query.setLimit(event.target.value);\n            }}\n            min=\"1\"\n          />{\" \"}\n          - Показано {length} строк -{\" \"}\n        </span>\n        <Save\n          name=\"View\"\n          apiUrl={`${baseUrl}api/views/`}\n          data={getPartsForQuery(query.query)}\n          redirectUrl={(view) => `/views/${view.pk}.html`}\n        />\n      </p>\n      <div className=\"MainSpace\">\n        <div className=\"FieldsList\">\n          <AllFields {...{ query, model }} path={[]} prettyPath={[]} />\n        </div>\n        {results}\n        <div />\n      </div>\n    </>\n  );\n}\n\nfunction EditSavedView(props) {\n  const { canMakePublic, baseUrl } = props;\n  const { pk } = useParams();\n  const url = `${baseUrl}api/views/${pk}/`;\n  const [view, setView] = useData(url);\n  if (!view) return \"\";\n  return (\n    <div className=\"EditSavedView\">\n      <div className=\"SavedViewActions\">\n        <span className=\"SavedViewTitle\">Сохранение запроса</span>\n        <Link to={view.link}>Открыть</Link>\n      </div>\n      <form>\n        <input\n          type=\"text\"\n          value={view.name}\n          onChange={(event) => {\n            setView({ name: event.target.value });\n          }}\n          className=\"SavedViewName\"\n          placeholder=\"Введите имя\"\n        />\n        <table>\n          <tbody>\n            <tr>\n              <th>Модель:</th>\n              <td>{validNames[view.model]}</td>\n            </tr>\n            <tr style={{display: 'none'}}>\n              <th>Поля:</th>\n              <td>{view.fields.replace(/,/g, \"\\u200b,\")}</td>\n            </tr>\n            <tr style={{display: 'none'}}>\n              <th>Фильтры:</th>\n              <td>{view.query.replace(/&/g, \"\\u200b&\")}</td>\n            </tr>\n            <tr style={{display: 'none'}}>\n              <th>Предел:</th>\n              <td className=\"SavedViewLimit\">\n                <input\n                  className=\"RowLimit\"\n                  type=\"number\"\n                  value={view.limit}\n                  onChange={(event) => {\n                    setView({ limit: event.target.value });\n                  }}\n                />\n              </td>\n            </tr>\n            <tr>\n              <th>Время создания:</th>\n              <td>{view.createdTime}</td>\n            </tr>\n          </tbody>\n        </table>\n        <textarea\n          value={view.description}\n          onChange={(event) => {\n            setView({ description: event.target.value });\n          }}\n          placeholder=\"Введите описание\"\n        />\n        {2 === 3 && (\n          <table>\n            <tbody>\n              <tr>\n                <th>Открыть доступ:</th>\n                <td>\n                  <input\n                    type=\"checkbox\"\n                    checked={view.public}\n                    onChange={(event) => {\n                      setView({ public: event.target.checked });\n                    }}\n                  />\n                </td>\n              </tr>\n              <tr>\n                <th>Ссылка:</th>\n                <td>{view.public && <CopyText text={view.publicLink} />}</td>\n              </tr>\n              <tr>\n                <th>Google Sheets:</th>\n                <td>\n                  {view.public && <CopyText text={view.googleSheetsFormula} />}\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        )}\n      </form>\n      <div className=\"SavedViewActions\">\n        <Delete apiUrl={url} redirectUrl=\"/\" />\n        <Link to=\"/\">Готово</Link>\n      </div>\n    </div>\n  );\n}\n\nfunction SavedViewList(props) {\n  const { baseUrl } = props;\n  const [savedViews] = useData(`${baseUrl}api/views/`);\n  if (!savedViews) return \"\";\n  return (\n    <div>\n      <h1>Сохранённые представления</h1>\n      <div>\n        {savedViews.map((view, index) => (\n          <div key={index}>\n            <p>\n              <Link className=\"Link\" to={view.link}>\n                {view.name} - {validNames[view.model]}\n              </Link>{\" \"}\n              (<Link to={`/views/${view.pk}.html`}>редактировать</Link>)\n            </p>\n            <p>{view.description}</p>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nfunction HomePage(props) {\n  const { sortedModels, allModelFields, baseUrl } = props;\n\n  const list = [];\n\n  for (let index = 0; index < sortedModels.length; index++) {\n    const element = sortedModels[index];\n    if (validNames[element]) {\n      list.push(element);\n    }\n  }\n\n  return (\n    <div className=\"Index\">\n      <div className='model_list'>\n        <h1>Модели</h1>\n        <div>\n          {list.map((model) => (\n            <div key={model}>\n              <Link\n                to={`/query/${model}/.html?${allModelFields[model].defaultFilters}`}\n                className=\"Link\"\n              >\n                {validNames[model]}\n              </Link>\n            </div>\n          ))}\n        </div>\n      </div>\n      <SavedViewList {...{ baseUrl }} />\n    </div>\n  );\n}\n\nexport { HomePage, QueryPage, Logo, LogoKS, EditSavedView };\n","import * as Sentry from \"@sentry/browser\";\nimport React from \"react\";\nimport { sortBy } from \"lodash\";\nimport {\n  BrowserRouter,\n  Switch,\n  Route,\n  useParams,\n  useLocation,\n} from \"react-router-dom\";\nimport \"./App.css\";\nimport { HomePage, QueryPage, LogoKS, EditSavedView } from \"./Components\";\nimport { Query, getUrlForQuery, empty } from \"./Query\";\nimport { doGet, fetchInProgress } from \"./Util\";\n\nconst assert = require(\"assert\");\n\nclass QueryApp extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      booting: true,\n      loading: false,\n      error: undefined,\n      model: \"\",\n      fields: [],\n      filters: [],\n      limit: props.config.defaultRowLimit,\n      ...empty,\n    };\n  }\n\n  handleError(e) {\n    if (e.name !== \"AbortError\") {\n      this.setState({ error: true, loading: false });\n      console.log(e);\n      Sentry.captureException(e);\n    }\n  }\n\n  fetchResults(state) {\n    this.setState({ loading: true });\n    const url = getUrlForQuery(this.props.config.baseUrl, state, \"json\");\n\n    return doGet(url).then((response) => {\n      this.setState({\n        body: response.body,\n        cols: response.cols,\n        rows: response.rows,\n        length: response.length,\n        formatHints: response.formatHints,\n        filterErrors: response.filterErrors,\n        loading: fetchInProgress,\n        error: undefined,\n      });\n      return response;\n    });\n  }\n\n  popstate(e) {\n    this.setState(e.state);\n    this.fetchResults(e.state).catch(this.handleError.bind(this));\n  }\n  popstate = this.popstate.bind(this);\n\n  componentDidMount() {\n    const { model, fieldStr, queryStr, config } = this.props;\n    const url = `${config.baseUrl}query/${model}/${fieldStr}.query${queryStr}`;\n    doGet(url).then((response) => {\n      const reqState = {\n        booting: false,\n        loading: true,\n        error: undefined,\n        model: response.model,\n        fields: response.fields,\n        filters: response.filters,\n        limit: response.limit,\n        ...empty,\n      };\n      this.setState(reqState);\n      window.history.replaceState(\n        reqState,\n        null,\n        getUrlForQuery(this.props.config.baseUrl, reqState, \"html\")\n      );\n      window.addEventListener(\"popstate\", this.popstate);\n      this.fetchResults(this.state).catch(this.handleError.bind(this));\n    });\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"popstate\", this.popstate);\n  }\n\n  handleQueryChange(queryChange) {\n    this.setState(queryChange);\n    const newState = { ...this.state, ...queryChange };\n    const request = {\n      model: newState.model,\n      fields: newState.fields,\n      filters: newState.filters,\n      limit: newState.limit,\n      ...empty,\n    };\n    window.history.pushState(\n      request,\n      null,\n      getUrlForQuery(this.props.config.baseUrl, newState, \"html\")\n    );\n    this.fetchResults(newState)\n      .then((response) => {\n        const res = { ...response, ...empty };\n        res.filters = sortBy(res.filters, [\"pathStr\"]);\n        const req = { ...request };\n        req.filters = sortBy(req.filters, [\"pathStr\"]);\n        assert.deepStrictEqual(res, req);\n      })\n      .catch(this.handleError.bind(this));\n  }\n\n  render() {\n    if (this.state.booting) return \"\";\n    const query = new Query(\n      this.props.config,\n      this.state,\n      this.handleQueryChange.bind(this)\n    );\n    return (\n      <QueryPage\n        query={query}\n        sortedModels={this.props.config.sortedModels}\n        allModelFields={this.props.config.allModelFields}\n        baseUrl={this.props.config.baseUrl}\n        {...this.state}\n      />\n    );\n  }\n}\n\nfunction Bob(props) {\n  const { model, fieldStr } = useParams();\n  return (\n    <QueryApp\n      {...props}\n      model={model}\n      fieldStr={fieldStr || \"\"}\n      queryStr={useLocation().search}\n    />\n  );\n}\n\nfunction App(props) {\n  const { baseUrl, sortedModels, allModelFields, canMakePublic } = props;\n  return (\n    <BrowserRouter basename={baseUrl}>\n      <div id=\"body\">\n        <Switch>\n          <Route path=\"/query/:model/:fieldStr?.html\">\n            <Bob config={props} {...{ sortedModels }} />\n          </Route>\n          <Route path=\"/views/:pk.html\">\n            <EditSavedView {...{ baseUrl, canMakePublic }} />\n          </Route>\n          <Route path=\"/\">\n            <HomePage {...{ sortedModels, allModelFields, baseUrl }} />\n          </Route>\n        </Switch>\n      </div>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport * as Sentry from \"@sentry/browser\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nconst config = JSON.parse(\n    document.getElementById(\"backend-config\").textContent\n);\nconst version = document.getElementById(\"backend-version\").textContent.trim();\n\nif (config.sentryDsn) {\n    Sentry.init({\n        dsn: config.sentryDsn,\n        release: version,\n        attachStacktrace: true,\n        maxValueLength: 10000,\n    });\n}\n\nReactDOM.render(\n    <React.StrictMode>\n        <App {...config} />\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n);\n"],"sourceRoot":""}