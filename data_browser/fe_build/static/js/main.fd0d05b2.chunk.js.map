{"version":3,"sources":["Util.js","Results.js","Components.js","Query.js","App.js","serviceWorker.js","index.js"],"names":["TLink","props","className","onClick","children","type","SLink","Spacer","spaces","Array","map","_","key","HeadCell","query","field","modelField","getField","path","getType","removeField","canPivot","togglePivot","pivoted","concrete","defaultLookup","addFilter","prettyPath","toggleSort","join","dsc","priority","asc","null","sort","DataCell","formattedValue","span","value","undefined","dangerouslySetInnerHTML","__html","String","colSpan","VTableHeadRow","fields","classNameFirst","i","pathStr","VTableBodyRow","row","HTableRow","data","col","Results","cols","rows","body","colFields","rowFields","length","resFields","rowIndex","table","FilterValue","lookup","onChange","weekday","month","step","Filter","this","index","errorMessage","removeFilter","addField","e","setFilterLookup","target","sortedLookups","lookupName","replace","setFilterValue","lookups","React","Component","Filters","filterErrors","filters","filter","Field","state","toggled","setState","model","toggle","bind","prettyName","AllFields","modelFields","getModelFields","sortedFields","fieldName","concat","ModelSelector","setModel","sortedModels","Logo","version","to","QueryPage","saveUrl","getUrlForSave","id","href","getUrlForMedia","SavedViewList","baseUrl","savedViews","url","useState","setData","useEffect","fetch","then","response","json","useData","view","link","name","description","HomePage","empty","getPartsForQuery","f","getUrlForQuery","media","parts","basePath","window","location","origin","controller","Query","config","setQuery","slice","allModelFields","types","defaultValue","newFields","push","findIndex","newSort","newFilters","getDefaultLookupValue","splice","adminUrl","model_name","queryString","URLSearchParams","toString","assert","require","handleError","console","log","Sentry","QueryApp","booting","abort","AbortController","signal","reload","fieldStr","queryStr","reqState","history","replaceState","onpopstate","fetchResults","catch","queryChange","newState","request","pushState","deepStrictEqual","handleQueryChange","Bob","params","useParams","useLocation","search","App","basename","Boolean","hostname","match","djangoData","JSON","parse","document","getElementById","textContent","sentryDsn","dsn","release","attachStacktrace","maxValueLength","ReactDOM","render","StrictMode","navigator","serviceWorker","ready","registration","unregister","error","message"],"mappings":"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","file":"static/js/main.fd0d05b2.chunk.js","sourcesContent":["import React from \"react\";\nimport \"./App.css\";\n\nfunction TLink(props) {\n    const { className, onClick, children } = props;\n    return (\n        <button\n            {...{ onClick }}\n            type=\"button\"\n            className={\"Link \" + (className || \"\")}\n        >\n            {children}\n        </button>\n    );\n}\n\nfunction SLink(props) {\n    const { className, onClick, children } = props;\n    return (\n        <button\n            {...{ onClick }}\n            type=\"button\"\n            className={\"sLink material-icons \" + (className || \"\")}\n        >\n            {children}\n        </button>\n    );\n}\n\nexport { TLink, SLink };\n","import React from \"react\";\nimport \"./App.css\";\nimport { TLink, SLink } from \"./Util.js\";\n\nfunction Spacer(props) {\n  const { spaces } = props;\n  if (spaces > 0) {\n    return [...Array(spaces)].map((_, key) => (\n      <td className=\"Empty\" key={key} />\n    ));\n  }\n  return null;\n}\n\nfunction HeadCell(props) {\n  const { query, field, className } = props;\n  const modelField = query.getField(field.path);\n  const type = query.getType(modelField);\n  return (\n    <th {...{ className }}>\n      <SLink onClick={() => query.removeField(field)}>close</SLink>\n      {modelField.canPivot && (\n        <>\n          <SLink onClick={() => query.togglePivot(field)}>\n            {field.pivoted ? \"call_received\" : \"call_made\"}\n          </SLink>\n        </>\n      )}\n      {modelField.concrete && type.defaultLookup ? (\n        <>\n          <SLink onClick={() => query.addFilter(field.path, field.prettyPath)}>\n            filter_alt\n          </SLink>{\" \"}\n          <TLink onClick={() => query.toggleSort(field)}>\n            {field.prettyPath.join(\" \")}\n            {\n              {\n                dsc: `↑${field.priority}`,\n                asc: `↓${field.priority}`,\n                null: \"\",\n              }[field.sort]\n            }\n          </TLink>\n        </>\n      ) : (\n        \" \" + field.prettyPath.join(\" \")\n      )}\n    </th>\n  );\n}\n\nfunction DataCell(props) {\n  const { query, field, className, span, value } = props;\n  let modelField = query.getField(field.path);\n  let formattedValue;\n  if (value === undefined) {\n    formattedValue = \"\";\n  } else if (modelField.type === \"html\" && value) {\n    formattedValue = <div dangerouslySetInnerHTML={{ __html: value }} />;\n  } else {\n    formattedValue = String(value);\n  }\n  return (\n    <td className={modelField.type + \" \" + className || \"\"} colSpan={span || 1}>\n      {formattedValue}\n    </td>\n  );\n}\n\nfunction VTableHeadRow(props) {\n  const { fields, query, classNameFirst } = props;\n  return fields.map((field, i) => (\n    <HeadCell\n      {...{ query, field }}\n      key={field.pathStr}\n      className={\"HoriBorder \" + (i ? \"\" : classNameFirst)}\n    />\n  ));\n}\n\nfunction VTableBodyRow(props) {\n  const { fields, query, classNameFirst, row } = props;\n  return fields.map((field, i) => (\n    <DataCell\n      {...{ query, field }}\n      key={field.pathStr}\n      value={row[field.pathStr]}\n      className={i ? \"\" : classNameFirst}\n    />\n  ));\n}\n\nfunction HTableRow(props) {\n  const { query, field, data, span } = props;\n  return (\n    <>\n      <HeadCell {...{ query, field }} />\n      {data.map((col, key) => (\n        <DataCell {...{ key, query, field, span }} value={col[field.pathStr]} />\n      ))}\n    </>\n  );\n}\n\nfunction Results(props) {\n  const { query, cols, rows, body } = props;\n  return (\n    <table className=\"Results\">\n      <thead>\n        {/* pivoted data */}\n        {query.colFields().map((field) => {\n          return (\n            <tr key={field.pathStr}>\n              <Spacer spaces={query.rowFields().length - 1} />\n              <HTableRow\n                {...{ query, field }}\n                span={query.resFields().length}\n                data={cols}\n              />\n            </tr>\n          );\n        })}\n\n        {/* column headers */}\n        <tr>\n          <Spacer spaces={1 - query.rowFields().length} />\n          <VTableHeadRow {...{ query }} fields={query.rowFields()} />\n          {cols.map((_, key) => (\n            <VTableHeadRow\n              {...{ key, query }}\n              fields={query.resFields()}\n              classNameFirst=\"LeftBorder\"\n            />\n          ))}\n        </tr>\n      </thead>\n\n      {/* row headers and body */}\n      <tbody>\n        {rows.map((row, rowIndex) => (\n          <tr key={rowIndex}>\n            <Spacer spaces={1 - query.rowFields().length} />\n            <VTableBodyRow {...{ query, row }} fields={query.rowFields()} />\n            {body.map((table, key) => (\n              <VTableBodyRow\n                {...{ key, query }}\n                fields={query.resFields()}\n                row={table[rowIndex]}\n                classNameFirst=\"LeftBorder\"\n              />\n            ))}\n          </tr>\n        ))}\n      </tbody>\n    </table>\n  );\n}\n\nexport { Results };\n","import React, { useState, useEffect } from \"react\";\nimport \"./App.css\";\nimport { TLink, SLink } from \"./Util.js\";\nimport { Results } from \"./Results.js\";\nimport { Link } from \"react-router-dom\";\n\nfunction FilterValue(props) {\n  const { lookup, onChange, value } = props;\n  if (props.lookup.type === \"boolean\")\n    return (\n      <select {...{ onChange, value }} className=\"FilterValue\">\n        <option value={true}>true</option>\n        <option value={false}>false</option>\n      </select>\n    );\n  else if (lookup.type === \"weekday\")\n    return (\n      <select {...{ onChange, value }} className=\"FilterValue\">\n        {[\n          \"Sunday\",\n          \"Monday\",\n          \"Tuesday\",\n          \"Wednesday\",\n          \"Thursday\",\n          \"Friday\",\n          \"Saturday\",\n        ].map((weekday) => (\n          <option value={weekday}>{weekday}</option>\n        ))}\n      </select>\n    );\n  else if (lookup.type === \"month\")\n    return (\n      <select {...{ onChange, value }} className=\"FilterValue\">\n        {[\n          \"January\",\n          \"Febuary\",\n          \"March\",\n          \"April\",\n          \"May\",\n          \"June\",\n          \"July\",\n          \"August\",\n          \"September\",\n          \"October\",\n          \"November\",\n          \"December\",\n        ].map((month) => (\n          <option value={month}>{month}</option>\n        ))}\n      </select>\n    );\n  else if (lookup.type === \"number\" || lookup.type === \"year\")\n    return (\n      <input\n        {...{ onChange, value }}\n        className=\"FilterValue\"\n        type=\"number\"\n        step=\"0\"\n      />\n    );\n  else\n    return (\n      <input {...{ onChange, value }} className=\"FilterValue\" type=\"text\" />\n    );\n}\n\nclass Filter extends React.Component {\n  render() {\n    const {\n      path,\n      prettyPath,\n      index,\n      lookup,\n      query,\n      value,\n      errorMessage,\n    } = this.props;\n    const type = query.getType(query.getField(path));\n    return (\n      <tr>\n        <td>\n          <SLink onClick={() => query.removeFilter(index)}>close</SLink>{\" \"}\n          <TLink onClick={() => query.addField(path, prettyPath)}>\n            {prettyPath.join(\" \")}\n          </TLink>{\" \"}\n        </td>\n        <td>\n          <select\n            className=\"Lookup\"\n            value={lookup}\n            onChange={(e) => query.setFilterLookup(index, e.target.value)}\n          >\n            {type.sortedLookups.map((lookupName) => (\n              <option key={lookupName} value={lookupName}>\n                {lookupName.replace(/_/g, \" \")}\n              </option>\n            ))}\n          </select>\n        </td>\n        <td>=</td>\n        <td>\n          <FilterValue\n            {...{ value }}\n            onChange={(e) => query.setFilterValue(index, e.target.value)}\n            lookup={type.lookups[lookup]}\n          />\n          {errorMessage && <p>{errorMessage}</p>}\n        </td>\n      </tr>\n    );\n  }\n}\n\nfunction Filters(props) {\n  const { query, filterErrors } = props;\n  return (\n    <form className=\"Filters\">\n      <table className=\"Flat\">\n        <tbody>\n          {props.filters.map((filter, index) => (\n            <Filter\n              {...{ query, index }}\n              {...filter}\n              key={index}\n              errorMessage={filterErrors[index]}\n            />\n          ))}\n        </tbody>\n      </table>\n    </form>\n  );\n}\n\nclass Field extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { toggled: false };\n  }\n\n  toggle() {\n    this.setState((state) => ({\n      toggled: !state.toggled,\n    }));\n  }\n\n  render() {\n    const { query, path, prettyPath, modelField } = this.props;\n    const type = query.getType(modelField);\n    return (\n      <>\n        <tr>\n          <td>\n            {modelField.concrete && type.defaultLookup && (\n              <SLink onClick={() => query.addFilter(path, prettyPath)}>\n                filter_alt\n              </SLink>\n            )}\n          </td>\n          <td>\n            {modelField.model && (\n              <SLink className=\"ToggleLink\" onClick={this.toggle.bind(this)}>\n                {this.state.toggled ? \"remove\" : \"add\"}\n              </SLink>\n            )}\n          </td>\n          <td>\n            {modelField.type ? (\n              <TLink onClick={() => query.addField(path, prettyPath)}>\n                {modelField.prettyName}\n              </TLink>\n            ) : (\n              modelField.prettyName\n            )}\n          </td>\n        </tr>\n        {this.state.toggled && (\n          <tr>\n            <td></td>\n            <td colSpan=\"2\">\n              <AllFields\n                {...{ query, path, prettyPath }}\n                model={modelField.model}\n              />\n            </td>\n          </tr>\n        )}\n      </>\n    );\n  }\n}\n\nfunction AllFields(props) {\n  const { query, model, path, prettyPath } = props;\n  const modelFields = query.getModelFields(model);\n  return (\n    <table>\n      <tbody>\n        {modelFields.sortedFields.map((fieldName) => {\n          const modelField = modelFields.fields[fieldName];\n          return (\n            <Field\n              key={fieldName}\n              {...{ query, modelField }}\n              path={path.concat([fieldName])}\n              prettyPath={prettyPath.concat([modelField.prettyName])}\n            />\n          );\n        })}\n      </tbody>\n    </table>\n  );\n}\n\nfunction ModelSelector(props) {\n  return (\n    <select\n      className=\"ModelSelector\"\n      onChange={(e) => props.query.setModel(e.target.value)}\n      value={props.model}\n    >\n      {props.sortedModels.map((model) => (\n        <option key={model}>{model}</option>\n      ))}\n    </select>\n  );\n}\n\nfunction Logo(props) {\n  const { version } = props;\n  return (\n    <Link to=\"/\" className=\"Logo\">\n      <span>DDB</span>\n      <span className=\"Version\">v{version}</span>\n    </Link>\n  );\n}\n\nfunction QueryPage(props) {\n  const {\n    query,\n    rows,\n    cols,\n    body,\n    version,\n    sortedModels,\n    model,\n    filters,\n    filterErrors,\n  } = props;\n  const saveUrl = query.getUrlForSave();\n  return (\n    <div id=\"body\">\n      <Logo {...{ version }} />\n      <ModelSelector {...{ query, sortedModels, model }} />\n      <Filters {...{ query, filters, filterErrors }} />\n      <p>\n        Showing {rows.length * cols.length} results -{\" \"}\n        <a href={query.getUrlForMedia(\"csv\")}>Download as CSV</a> -{\" \"}\n        <a href={query.getUrlForMedia(\"json\")}>View as JSON</a>\n        {saveUrl && (\n          <>\n            {\" \"}\n            - <a href={saveUrl}>Save View</a>{\" \"}\n          </>\n        )}\n      </p>\n      <div className=\"MainSpace\">\n        <div className=\"FieldsList\">\n          <AllFields {...{ query, model }} path={[]} prettyPath={[]} />\n        </div>\n        {query.rowFields().length || query.colFields().length ? (\n          <Results {...{ query, rows, cols, body }} />\n        ) : (\n          <h2>No fields selected</h2>\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction useData(url) {\n  const [data, setData] = useState([]);\n  useEffect(() => {\n    fetch(url)\n      .then((response) => response.json())\n      .then((response) => {\n        setData(response);\n      });\n  }, [url]);\n  return data;\n}\n\nfunction SavedViewList(props) {\n  const { baseUrl } = props;\n  const savedViews = useData(`${baseUrl}api/views/`);\n  return (\n    <div>\n      <h1>Saved Views</h1>\n      <div>\n        {savedViews.map((view, index) => (\n          <div key={index}>\n            <Link className=\"Link\" to={view.link}>\n              {view.model} - {view.name}\n            </Link>\n            <p>{view.description}</p>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nfunction HomePage(props) {\n  const { version, sortedModels, baseUrl } = props;\n  return (\n    <div id=\"body\">\n      <Logo {...{ version }} />\n      <div className=\"Index\">\n        <div>\n          <h1>Models</h1>\n          <div>\n            {sortedModels.map((model) => (\n              <div key={model}>\n                <Link to={`/query/${model}/.html`} className=\"Link\">\n                  {model}\n                </Link>\n              </div>\n            ))}\n          </div>\n        </div>\n        <SavedViewList {...{ baseUrl }} />\n      </div>\n    </div>\n  );\n}\n\nexport { HomePage, QueryPage };\n","const empty = {\n  rows: [{}],\n  cols: [{}],\n  body: [[{}]],\n  filterErrors: [],\n};\n\nfunction getPartsForQuery(query) {\n  return {\n    model: query.model,\n    fields: query.fields\n      .map(\n        (f) =>\n          (f.pivoted ? \"&\" : \"\") +\n          f.path.join(\"__\") +\n          { asc: `+${f.priority}`, dsc: `-${f.priority}`, null: \"\" }[f.sort]\n      )\n      .join(\",\"),\n    query: query.filters\n      .map((f) => `${f.path.join(\"__\")}__${f.lookup}=${f.value}`)\n      .join(\"&\"),\n  };\n}\n\nfunction getUrlForQuery(baseUrl, query, media) {\n  const parts = getPartsForQuery(query);\n  const basePath = `${baseUrl}query/${parts.model}`;\n  return `${window.location.origin}${basePath}/${parts.fields}.${media}?${parts.query}`;\n}\n\nclass Query {\n  constructor(config, query, setQuery) {\n    this.config = config;\n    this.query = query;\n    this.setQuery = setQuery;\n  }\n\n  getField(path) {\n    const field = path.slice(-1);\n    let model = this.query.model;\n    for (const field of path.slice(0, -1)) {\n      model = this.config.allModelFields[model].fields[field].model;\n    }\n    return this.config.allModelFields[model].fields[field];\n  }\n\n  getType(field) {\n    return this.config.types[field.type];\n  }\n\n  getModelFields(model) {\n    return this.config.allModelFields[model];\n  }\n\n  getDefaultLookupValue(type, lookup) {\n    return String(this.config.types[type.lookups[lookup].type].defaultValue);\n  }\n\n  addField(path, prettyPath) {\n    const newFields = this.query.fields.slice();\n    newFields.push({\n      path: path,\n      pathStr: path.join(\"__\"),\n      prettyPath: prettyPath,\n      sort: null,\n      priority: null,\n      pivoted: false,\n    });\n    this.setQuery({ fields: newFields });\n  }\n\n  removeField(field) {\n    this.setQuery({\n      fields: this.query.fields.filter((f) => f.pathStr !== field.pathStr),\n    });\n  }\n\n  toggleSort(field) {\n    const index = this.query.fields.findIndex(\n      (f) => f.pathStr === field.pathStr\n    );\n    const newSort = { asc: \"dsc\", dsc: null, null: \"asc\" }[field.sort];\n    let newFields = this.query.fields.slice();\n\n    if (field.sort) {\n      // move any later sort fields forward\n      newFields = newFields.map((f) => ({\n        ...f,\n        priority:\n          f.priority != null && f.priority > field.priority\n            ? f.priority - 1\n            : f.priority,\n      }));\n    }\n\n    if (newSort) {\n      // move all other fiels back and insert the updated one\n      newFields = newFields.map((f) => ({\n        ...f,\n        priority: f.priority != null ? f.priority + 1 : f.priority,\n      }));\n      newFields[index] = { ...field, sort: newSort, priority: 0 };\n    } else {\n      // blank the sort on the updated field\n      newFields[index] = { ...field, sort: null, priority: null };\n    }\n\n    this.setQuery({\n      fields: newFields,\n    });\n  }\n\n  togglePivot(field) {\n    const index = this.query.fields.findIndex(\n      (f) => f.pathStr === field.pathStr\n    );\n    let newFields = this.query.fields.slice();\n    newFields[index].pivoted = !newFields[index].pivoted;\n    this.setQuery({\n      fields: newFields,\n    });\n  }\n\n  addFilter(path, prettyPath) {\n    const type = this.getType(this.getField(path));\n    const newFilters = this.query.filters.slice();\n    newFilters.push({\n      path: path,\n      pathStr: path.join(\"__\"),\n      prettyPath: prettyPath,\n      lookup: type.defaultLookup,\n      value: this.getDefaultLookupValue(type, type.defaultLookup),\n    });\n    this.setQuery({ filters: newFilters });\n  }\n\n  removeFilter(index) {\n    const newFilters = this.query.filters.slice();\n    newFilters.splice(index, 1);\n    this.setQuery({ filters: newFilters });\n  }\n\n  setFilterValue(index, value) {\n    const newFilters = this.query.filters.slice();\n    newFilters[index] = { ...newFilters[index], value: value };\n    this.setQuery({ filters: newFilters });\n  }\n\n  setFilterLookup(index, lookup) {\n    const newFilters = this.query.filters.slice();\n    const filter = newFilters[index];\n    const type = this.getType(this.getField(newFilters[index].path));\n    if (type.lookups[filter.lookup].type !== type.lookups[lookup].type) {\n      filter.value = this.getDefaultLookupValue(type, lookup);\n    }\n    filter.lookup = lookup;\n    this.setQuery({ filters: newFilters });\n  }\n\n  setModel(model) {\n    this.setQuery({\n      model: model,\n      fields: [],\n      filters: [],\n      ...empty,\n    });\n  }\n\n  getUrlForSave() {\n    if (this.config.adminUrl === null) return null;\n    const parts = getPartsForQuery(this.query);\n    parts.model_name = parts.model;\n    const queryString = new URLSearchParams(parts).toString();\n    return `${window.location.origin}${this.config.adminUrl}?${queryString}`;\n  }\n\n  getUrlForMedia(media) {\n    return getUrlForQuery(this.config.baseUrl, this.query, media);\n  }\n\n  colFields() {\n    return this.query.fields.filter((f) => f.pivoted);\n  }\n\n  rowFields() {\n    if (this.colFields().length) {\n      return this.query.fields.filter(\n        (f) => !f.pivoted && this.getField(f.path).canPivot\n      );\n    } else {\n      return this.query.fields;\n    }\n  }\n\n  resFields() {\n    if (this.colFields().length) {\n      return this.query.fields.filter((f) => !this.getField(f.path).canPivot);\n    } else {\n      return [];\n    }\n  }\n}\n\nexport { Query, getPartsForQuery, getUrlForQuery, empty };\n","import * as Sentry from \"@sentry/browser\";\nimport React from \"react\";\nimport \"./App.css\";\nimport { HomePage, QueryPage } from \"./Components\";\nimport { Query, getUrlForQuery, empty } from \"./Query\";\nimport {\n  BrowserRouter,\n  Switch,\n  Route,\n  useParams,\n  useLocation,\n} from \"react-router-dom\";\n\nconst assert = require(\"assert\");\nlet controller;\n\nfunction handleError(e) {\n  if (e.name === \"AbortError\") {\n    console.log(\"request aborted\");\n  } else {\n    console.log(e);\n    Sentry.captureException(e);\n  }\n}\n\nclass QueryApp extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      booting: true,\n      version: props.config.version,\n      model: \"\",\n      fields: [],\n      filters: [],\n      ...empty,\n    };\n  }\n\n  fetchResults(state) {\n    const url = getUrlForQuery(this.props.config.baseUrl, state, \"json\");\n\n    if (controller) controller.abort();\n    controller = new AbortController();\n\n    return fetch(url, { signal: controller.signal })\n      .then((response) => response.json())\n      .then((response) => {\n        if (response.version !== this.state.version) {\n          console.log(\"Version mismatch, hard reload\");\n          window.location.reload(true);\n        }\n        delete response.version;\n        return response;\n      })\n      .then((response) => {\n        this.setState({\n          body: response.body,\n          cols: response.cols,\n          rows: response.rows,\n          filterErrors: response.filterErrors,\n        });\n        return response;\n      });\n  }\n\n  componentDidMount() {\n    const { model, fieldStr, queryStr, config } = this.props;\n    const url = `${config.baseUrl}query/${model}/${fieldStr}.query${queryStr}`;\n    fetch(url)\n      .then((response) => response.json())\n      .then((response) => {\n        const reqState = {\n          booting: false,\n          model: response.model,\n          fields: response.fields,\n          filters: response.filters,\n          ...empty,\n        };\n        this.setState(reqState);\n        window.history.replaceState(\n          reqState,\n          null,\n          getUrlForQuery(this.props.config.baseUrl, reqState, \"html\")\n        );\n        window.onpopstate = (e) => {\n          this.fetchResults(e.state).catch(handleError);\n          this.setState(e.state);\n        };\n        this.fetchResults(this.state).catch(handleError);\n      });\n  }\n\n  componentWillUnmount() {\n    window.onpopstate = () => {};\n  }\n\n  handleQueryChange(queryChange) {\n    this.setState(queryChange);\n    const newState = { ...this.state, ...queryChange };\n    const request = {\n      model: newState.model,\n      fields: newState.fields,\n      filters: newState.filters,\n      ...empty,\n    };\n    window.history.pushState(\n      request,\n      null,\n      getUrlForQuery(this.props.config.baseUrl, newState, \"html\")\n    );\n    this.fetchResults(newState)\n      .then((response) => {\n        response = { ...response, ...empty };\n        assert.deepStrictEqual(response, request);\n      })\n      .catch(handleError);\n  }\n\n  render() {\n    if (this.state.booting) return \"\";\n    const query = new Query(\n      this.props.config,\n      this.state,\n      this.handleQueryChange.bind(this)\n    );\n    return (\n      <QueryPage\n        query={query}\n        sortedModels={this.props.config.sortedModels}\n        version={this.props.config.version}\n        {...this.state}\n      />\n    );\n  }\n}\n\nfunction Bob(props) {\n  const params = useParams();\n  return (\n    <QueryApp\n      {...props}\n      model={params.model}\n      fieldStr={params.fieldStr || \"\"}\n      queryStr={useLocation().search}\n    />\n  );\n}\n\nfunction App(props) {\n  const { config, sortedModels } = props;\n  return (\n    <BrowserRouter basename={config.baseUrl}>\n      <Switch>\n        <Route path=\"/query/:model/:fieldStr?.html\">\n          <Bob {...{ config, sortedModels }} />\n        </Route>\n        <Route path=\"/\">\n          <HomePage\n            sortedModels={config.sortedModels}\n            version={config.version}\n            baseUrl={config.baseUrl}\n          />\n        </Route>\n      </Switch>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport * as Sentry from \"@sentry/browser\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nconst djangoData = JSON.parse(\n    document.getElementById(\"django-data\").textContent\n);\n\nif (djangoData.sentryDsn) {\n    Sentry.init({\n        dsn: djangoData.sentryDsn,\n        release: djangoData.config.version,\n        attachStacktrace: true,\n        maxValueLength: 10000,\n    });\n}\n\nReactDOM.render(\n    <React.StrictMode>\n        <App {...djangoData} />\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}